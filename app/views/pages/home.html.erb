
<div class="front_page_container">
    <h2>Meet Your Inspiration</h2>
    <p>Find The World's Most Beautiful Places! &nbsp;&nbsp;Help Pin The World's Greatest Travel Map!</p>
</div>

<input id="pac-input" class="controls" type="text" placeholder="Search The Earth">

<div id="amap"></div>

<div class="top_banner">
    <h2>The Five Most Beautiful Places In The World</h2>
</div>
  
<div class="top_photo" style="background-image: url('<%= asset_path("ifalls.jpg")%>')">
</div>

<div class="top_title">
    <h4>1. Iguazu Falls - Argentina & Brazil</h4>
        <div class="top_caption">
            <p>The largest waterfalls system in the world. Iguazu Falls sits on the borders of the Argentine province of Misiones and the Brazilian state of Paran√°. Igauzu consists of over 270 waterfalls, with the largest being called "La Garganta Del Diablo" or The Devil's Throat.</p>
        </div>
</div>

<div class="top_photo" style="background-image: url('<%= asset_path("storms-river-mouth.jpg")%>')">
</div>

<div class="top_title">
    <h4 style="text-align: right;">2. Tsitsikamma National Park - South Africa</h4>
        <div class="top_caption" style="margin-left:auto; margin-right:0; text-align: right;">
            <p>One of South Africa's many beautiful national parks, Tsitsikamma is known for its forests and stunning coastline. Pictured here is Storms River Mouth, one of the many rivers that flow through the park.</p>
        </div>
</div>
  
<div class="top_photo" style="background-image: url('<%= asset_path("glacier-mountain1.jpg") %>')">
</div>

<div class="top_title">
    <h4>3. Glacier National Park - United States</h4>
        <div class="top_caption">
            <p>Glacier National Park might need to be renamed in a few years. If the current warming trend continues, all of its glaicers are expected to melt by 2035. Nonetheless, it is still one of America's most diverse and beautiful national parks</p>
        </div>
</div>
 
<div class="top_photo" style="background-image: url('<%= asset_path("yosemite-national-vallye.jpg") %>')">
</div>  

<div class="top_title">
    <h4 style="text-align: right;">4. Yosemite National Park - United States</h4>
        <div class="top_caption" style="margin-left:auto; margin-right:0; text-align: right;">
            <p>Yosemite is internationally recognized for its granite cliffs, waterfalls, clear streams, giant sequoia groves, lakes, mountains, glaciers, and biological diversity. Yosemite Valley, pictured above, only represents one percent of this national park. </p>
        </div>
</div>

<div class="top_photo" style="background-image: url('<%= asset_path("ko-phi-phi.jpg") %>')">
</div>

<div class="top_title">
    <h4>5. Ko Phi Phi - Thailand</h4>
        <div class="top_caption">
            <p>A small group of islands in the Indian Ocean, Ko Phi Phi came to worldwide prominence when Ko Phi Phi Leh (Maya Bay) was used as a location for the 2000 British-American film The Beach. The islands are now a popular party destination for young tourists. </p>
        </div>
</div>
  


  <script>

      function initAutocomplete() {
        var map = new google.maps.Map(document.getElementById('amap'), {
          zoom: 2,
          center: {lat: 40.5994, lng: 28.6731},
          mapTypeId: 'terrain',
          styles: [
            { 
              featureType: 'administrative.country',
              elementType: 'geometry.fill',
              stylers: [{color: '#FFFFFF'}]
            },
            { 
              featureType: 'administrative.country',
              elementType: 'geometry.stroke',
              stylers: [{color: '#FFFFFF'}]
            },
            {
              featureType: 'landscape.natural.landcover',
              elementType: 'geometry.fill',
              stylers: [{color: '#34A56F'}]
            },
            {
              featureType: 'landscape.natural.terrain',
              elementType: 'geometry.fill',
              stylers: [{color: '#FFFAFA'}]
            },
            {
              featureType: 'road.local',
              elementType: 'geometry.fill',
              stylers: [{color: '#D3D3D3'}]
            },
            {
              featureType: 'road.local',
              elementType: 'geometry.stroke',
              stylers: [{color: '#D3D3D3'}]
            },
            {
              featureType: 'road.highway',
              elementType: 'geometry.fill',
              stylers: [{color: '#D3D3D3'}]
            },
            {
              featureType: 'road.highway',
              elementType: 'geometry.stroke',
              stylers: [{color: '#D3D3D3'}]
            },
            { 
              featureType: 'poi.park',
              elementType: 'geometry.fill',
              stylers: [{color: '#7CFC00'}]
            },
            { 
              featureType: 'poi.park',
              elementType: 'labels.text.fill',
              stylers: [{color: '#FFFFFF'}]
            },
            { 
              featureType: 'poi.park',
              elementType: 'labels.text.stroke',
              stylers: [{color: '#000000'}]
            },
            {
              featureType: 'water',
              elementType: 'geometry',
              stylers: [{color: '#00E5EE'}]
            },
          ]
          });

          // Create the search box and link it to the UI element.
        var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function() {
          searchBox.setBounds(map.getBounds());
        });

        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener('places_changed', function() {
          var places = searchBox.getPlaces();

          if (places.length == 0) {
            return;
          }


          // For each place, get the icon, name and location.
          var bounds = new google.maps.LatLngBounds();
          places.forEach(function(place) {
            if (!place.geometry) {
              console.log("Returned place contains no geometry");
              return;
            }
            var icon = {
              url: place.icon,
              size: new google.maps.Size(71, 71),
              origin: new google.maps.Point(0, 0),
              anchor: new google.maps.Point(17, 34),
              scaledSize: new google.maps.Size(25, 25)
            };

            if (place.geometry.viewport) {
              // Only geocodes have viewport.
              bounds.union(place.geometry.viewport);
            } else {
              bounds.extend(place.geometry.location);
            }
          });
          map.fitBounds(bounds);
        });

          // Create an array of alphabetical characters used to label the markers.
       // var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function(location, i) {
            return new google.maps.Marker({
            position: location,
          });
      });


var urlArray = <%= @url_array.to_json.to_s.html_safe %>

function linkMarkers() {
  for (var i = 0; i < markers.length; i++) {
    (function (i) {
  markers[i].addListener('click', function() {
      window.location.href = '/places/' + urlArray[i]
  }, false);
 })(i);
}
}

linkMarkers()



        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers, {
         imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'
  });
}

             var locations = [
      <% @places.each do |place| %>
      <% if place.latitude != nil && place.longitude != nil %>
        {lat: <%= place.latitude %> , lng: <%= place.longitude %>, url: '<%= place.url %>' },
      <% end %>
      <% end %>  
      ]
   

       </script>

       <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=<%= GOOGLE_MAPS_API_KEY %>&libraries=places&callback=initAutocomplete">
    </script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92007700-1', 'auto');
  ga('send', 'pageview');

</script>




